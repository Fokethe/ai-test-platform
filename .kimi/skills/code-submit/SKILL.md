---
name: code-submit
description: 代码提交工作流 - 审查→规范检查→文档更新→生成commit 完整流程
---

# Code Submit Skill

一键执行代码提交前的完整检查流程，确保代码质量、规范符合、文档同步。

## 触发方式

```bash
/skill:code-submit
```

或关键词：
- "提交代码"
- "commit"
- "准备提交"
- "写commit"

## 执行流程

```
┌─────────────────────────────────────────────────────────────┐
│  Step 1: cost-control                                       │
│  └─ 记录提交前消耗                                           │
├─────────────────────────────────────────────────────────────┤
│  Step 2: code-review                                        │
│  ├─ 全面代码审查                                             │
│  ├─ 可读性/性能/安全/类型检查                                │
│  └─ 输出审查报告                                             │
├─────────────────────────────────────────────────────────────┤
│  Step 3: project-context                                    │
│  ├─ 检查项目规范符合度                                        │
│  └─ 验证 KIMI.md 技术铁律                                    │
├─────────────────────────────────────────────────────────────┤
│  Step 4: doc-system                                         │
│  ├─ 更新 progress.txt                                       │
│  └─ 标记待提交状态                                           │
├─────────────────────────────────────────────────────────────┤
│  Step 5: git-commit                                         │
│  ├─ 分析改动内容                                             │
│  ├─ 生成标准 commit message                                 │
│  └─ 提供 commit 命令                                         │
├─────────────────────────────────────────────────────────────┤
│  Step 6: cost-control (总结)                                │
│  └─ 本次开发总消耗                                           │
└─────────────────────────────────────────────────────────────┘
```

## 提交前检查清单

```
✅ Code Review
   ├─ 可读性: 变量名语义化
   ├─ 错误处理: 异步/空值/边界
   ├─ 性能: 无重复计算
   ├─ 安全: 无敏感信息硬编码
   └─ 类型: TypeScript 严格

✅ Project Context
   └─ 符合 KIMI.md 规范

✅ Documentation
   └─ progress.txt 已更新
```

## 使用示例

```
用户: 提交代码
AI: [自动执行 /skill:code-submit]
    📊 当前消耗: $0.067
    
    [code-review] 审查中...
    🔍 检查最近修改: src/app/api/tests/route.ts
    ✅ 通过: 可读性良好
    ✅ 通过: 错误处理完善
    ⚠️  建议: 提取重复逻辑到 utils
    
    [project-context] 规范检查...
    ✅ 符合项目规范
    
    [doc-system] 更新文档...
    📝 已更新 progress.txt
    
    [git-commit] 生成提交信息...
    ```
    fix(api): 修复测试创建时的 projectId 验证
    
    - 从 URL 参数获取 projectId
    - 添加空值检查防止外键约束错误
    - 优化错误提示信息
    ```
    
用户: 确认提交
AI: git add -A && git commit -m "..."
   📊 本次开发总消耗: $0.067
```

## 快捷指令

- "跳过审查" → 跳过 code-review（不推荐）
- "强制提交" → 忽略警告直接生成 commit
