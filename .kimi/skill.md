---
name: doc-processor
description: 处理超过3万字的大型文档时，自动采用分段策略，避免上下文爆炸。Use when user references large markdown files or asks to process documentation.
---

# 大文档处理协议

## 触发条件

当文档字数 > 30,000 字符时激活。

## 执行流程

1. **立即暂停**：不要直接处理全文
2. **结构分析**：输出文档地图（建议分几块，每块字数）
3. **等待确认**：等待用户逐块发送内容
4. **逐块处理**：每块 < 8,000 字，输出摘要+重复标记+优化建议
5. **最终整合**：所有块完成后，输出合并后的文档结构和去重结果

## 禁止事项

- 禁止一次性读取 >5 万字
- 禁止在未制定分块计划前直接回答
- 每轮必须显示预估 Token 成本
