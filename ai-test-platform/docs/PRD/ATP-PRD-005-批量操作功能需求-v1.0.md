# AI Test Platform - 批量操作功能需求文档

> 文档编号: ATP-PRD-005
> 版本: v1.0
> 创建日期: 2026-02-17

---

## 1. 需求背景

用户需要高效地管理大量测试数据，批量操作可以显著提升工作效率。

---

## 2. 功能范围

### 2.1 适用模块

| 模块 | 批量操作类型 |
|------|-------------|
| 测试用例 | 批量删除、批量执行、批量修改优先级/状态、批量导出 |
| 测试套件 | 批量添加用例、批量移除用例、批量执行、批量删除 |
| 工作空间 | 批量导出 |
| 项目/系统/页面 | 批量删除、批量移动 |

### 2.2 本次实现范围（优先级）

**第一优先级：测试用例批量操作**
- 批量选择（复选框）
- 批量删除
- 批量执行
- 批量导出

**第二优先级：测试套件批量操作**
- 批量添加用例到套件
- 批量从套件移除

---

## 3. 交互设计

### 3.1 批量选择
```
┌─ 用例列表 ──────────────────────┐
│ ☐ | 用例标题          | 操作    │  ← 全选复选框
│ ☐ | 登录-正常流程      | [执行]  │
│ ☑ | 登录-错误密码      | [执行] │  ← 选中行高亮
│ ☑ | 登录-边界测试      | [执行] │
└─────────────────────────────────┘
```

### 3.2 批量操作工具栏
当选中项 > 0 时显示：
```
┌─ 批量操作工具栏 ──────────────────────────┐
│ 已选择 3 项                               │
│ [执行选中] [导出] [修改优先级 ▼] [删除 🗑] │
└───────────────────────────────────────────┘
```

### 3.3 确认对话框
- 删除前确认："确定要删除选中的 3 个测试用例吗？此操作不可恢复。"
- 执行前确认："确定要执行选中的 3 个测试用例吗？"

---

## 4. 技术方案

### 4.1 API设计

```typescript
// 批量删除
POST /api/testcases/batch-delete
Body: { ids: string[] }

// 批量执行
POST /api/testcases/batch-execute
Body: { ids: string[], config: ExecutionConfig }

// 批量导出
POST /api/testcases/batch-export
Body: { ids: string[], format: 'json' | 'csv' }

// 批量修改
POST /api/testcases/batch-update
Body: { ids: string[], data: Partial<TestCase> }
```

### 4.2 组件设计

```typescript
// 批量操作工具栏
interface BatchActionsToolbarProps {
  selectedIds: string[];
  onExecute: (ids: string[]) => void;
  onExport: (ids: string[]) => void;
  onDelete: (ids: string[]) => void;
  onUpdate: (ids: string[], data: any) => void;
}

// 行选择复选框
interface RowCheckboxProps {
  checked: boolean;
  onChange: (checked: boolean) => void;
}
```

---

## 5. 验收标准

- [ ] 列表每行显示复选框
- [ ] 支持全选/取消全选
- [ ] 选中行高亮显示
- [ ] 批量操作工具栏正确显示
- [ ] 批量删除需要确认
- [ ] 批量执行需要确认
- [ ] 导出功能正常
- [ ] 操作后有成功提示
- [ ] 列表自动刷新

---

## 6. 异常处理

| 场景 | 处理方式 |
|------|----------|
| 部分操作失败 | 显示成功/失败明细 |
| 全部失败 | 提示错误原因 |
| 选中项已被删除 | 刷新列表，提示已过期 |
| 无权限 | 提示权限不足 |
